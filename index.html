<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0b12" />
  <title>For Keira ğŸ’˜</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Background sparkle layer -->
  <div class="bg" aria-hidden="true">
    <div class="glow g1"></div>
    <div class="glow g2"></div>
    <div class="glow g3"></div>
  </div>

  <!-- Gate (pre-Feb 14) -->
  <main id="gate" class="screen hidden">
    <div class="card gate-card">
      <div class="gate-top">
        <button id="gateHeart" class="heart-btn" aria-label="Heart">
          <span class="heart-icon">ğŸ’Œ</span>
        </button>
        <div class="gate-title">
          <div class="pill">Just a little early</div>
          <h1>Open me tomorrow</h1>
          <p class="sub">This unlocks on Valentineâ€™s Day.</p>
        </div>
      </div>

      <div class="gate-mid">
        <div class="count-wrap">
          <div class="count-label">Countdown</div>
          <div id="countdown" class="countdown">â€”</div>
        </div>

        <div class="tiny tip">
          Tip: If youâ€™re Sam testing this, press <kbd>/</kbd> to bypass.
        </div>
      </div>

      <div class="gate-bottom tiny">
        Made with love (and mild secrecy).
      </div>
    </div>
  </main>

  <!-- Main App -->
  <main id="app" class="screen hidden">
    <header class="hero">
      <div class="hero-inner">
        <div class="hero-mark" aria-hidden="true">ğŸ’–</div>
        <div>
          <h1>Hi Keira</h1>
          <p class="sub">I made you a tiny page of our favourite moments.</p>
        </div>
      </div>
    </header>

    <section class="card">
      <div class="section-head">
        <h2>Little scrapbook</h2>
        <p class="sub">A few highlights I keep replaying in my head.</p>
      </div>

      <div class="grid" id="memoryGrid">
        <!-- Replace photos + captions -->
        <figure class="mem">
          <img src="photos/01.jpg" alt="A memory of us" loading="lazy" />
          <figcaption>That day we couldnâ€™t stop laughing.</figcaption>
        </figure>

        <figure class="mem">
          <img src="photos/02.jpg" alt="A memory of us" loading="lazy" />
          <figcaption>My favourite person, my favourite place.</figcaption>
        </figure>

        <figure class="mem">
          <img src="photos/03.jpg" alt="A memory of us" loading="lazy" />
          <figcaption>Proof that â€œusâ€ is my best idea.</figcaption>
        </figure>

        <figure class="mem">
          <img src="photos/04.jpg" alt="A memory of us" loading="lazy" />
          <figcaption>Justâ€¦ you. And how lucky I am.</figcaption>
        </figure>
      </div>

      <div class="split">
        <div class="note">
          <h3>Things I love about you</h3>
          <ul>
            <li>Your laugh â€” it resets my whole day.</li>
            <li>How you make home feel like a place, not a location.</li>
            <li>How you back me, even when Iâ€™m deep in â€œdebug modeâ€.</li>
            <li>Your kindness. Your brain. Your heart.</li>
          </ul>
        </div>

        <div class="note">
          <h3>Favourite â€œtinyâ€ moments</h3>
          <ul>
            <li>When we catch each otherâ€™s eyes and smirk.</li>
            <li>When youâ€™re telling a story and get animated.</li>
            <li>When we end up laughing at something dumb for ages.</li>
            <li>When you steal the blanket and pretend you didnâ€™t.</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="card ask">
      <div class="ask-head">
        <h2 id="question">Will you be my Valentine?</h2>
        <p class="sub" id="subline">Be honest. (But also choose wisely.)</p>
      </div>

      <div class="buttons">
        <button id="yesBtn" class="btn yes" type="button">Yes</button>
        <button id="noBtn" class="btn no" type="button">No</button>
      </div>

      <div class="tiny hint" id="hint"></div>
    </section>

    <section id="celebrate" class="card celebrate hidden" aria-live="polite">
      <div class="celebrate-top">
        <div class="celebrate-emoji" aria-hidden="true">ğŸ¥°</div>
        <div>
          <h2>Best news ever</h2>
          <p class="sub">You just made my whole week.</p>
        </div>
      </div>

      <div class="celebrate-mid">
        <div class="chips" aria-hidden="true">
          <span class="chip">ğŸŒ¹</span>
          <span class="chip">ğŸ«</span>
          <span class="chip">âœ¨</span>
          <span class="chip">ğŸ’–</span>
        </div>
        <p class="tiny">
          Happy Valentineâ€™s Day, Keira. I love you. â€” Sam
        </p>
      </div>

      <div class="celebrate-actions">
        <button id="confettiBtn" class="btn yes" type="button">Again</button>
        <button id="scrollTopBtn" class="btn ghost" type="button">Back to top</button>
      </div>
    </section>

    <!-- Optional music -->
    <audio id="song" src="audio/song.mp3" preload="auto"></audio>

    <footer class="footer tiny">
      Built by Sam â€¢ Powered by love â€¢ Deployed with questionable confidence
    </footer>
  </main>

  <script>
    // -------------------------------
    // SETTINGS
    // -------------------------------
    // Valentine unlock (Brisbane +10)
    // Change year if needed.
    const UNLOCK_AT = new Date("2026-02-14T00:00:00+10:00");

    // Secret bypass key
    const BYPASS_KEY = "/";

    // -------------------------------
    // Elements
    // -------------------------------
    const gateEl = document.getElementById("gate");
    const appEl = document.getElementById("app");
    const countdownEl = document.getElementById("countdown");
    const gateHeart = document.getElementById("gateHeart");

    const questionEl = document.getElementById("question");
    const sublineEl = document.getElementById("subline");
    const hintEl = document.getElementById("hint");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");

    const celebrateEl = document.getElementById("celebrate");
    const confettiBtn = document.getElementById("confettiBtn");
    const scrollTopBtn = document.getElementById("scrollTopBtn");
    const song = document.getElementById("song");

    // -------------------------------
    // Gate logic
    // -------------------------------
    function pad(n){ return String(n).padStart(2, "0"); }

    function showGate() {
      gateEl.classList.remove("hidden");
      appEl.classList.add("hidden");
      updateCountdown();
    }

    function showApp() {
      gateEl.classList.add("hidden");
      appEl.classList.remove("hidden");
    }

    function updateCountdown() {
      const t = UNLOCK_AT - new Date();
      if (t <= 0) {
        showApp();
        return;
      }
      const s = Math.floor(t / 1000);
      const d = Math.floor(s / 86400);
      const h = Math.floor((s % 86400) / 3600);
      const m = Math.floor((s % 3600) / 60);
      const sec = s % 60;
      countdownEl.textContent = `${d}d ${pad(h)}:${pad(m)}:${pad(sec)} (Brisbane time)`;
      setTimeout(updateCountdown, 250);
    }

    // secret bypass via "/"
    function enableBypass() {
      showApp();
      // optional: mark in session so refreshing stays bypassed
      try { sessionStorage.setItem("val_bypass", "1"); } catch (_) {}
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === BYPASS_KEY) enableBypass();
    });

    // mobile-friendly bypass: long press the heart for ~1.2s
    let pressTimer = null;
    gateHeart.addEventListener("pointerdown", () => {
      pressTimer = setTimeout(enableBypass, 1200);
    });
    gateHeart.addEventListener("pointerup", () => clearTimeout(pressTimer));
    gateHeart.addEventListener("pointerleave", () => clearTimeout(pressTimer));

    // initial gate decision
    const now = new Date();
    const bypassed = (() => {
      try { return sessionStorage.getItem("val_bypass") === "1"; } catch (_) { return false; }
    })();

    if (bypassed || now >= UNLOCK_AT) showApp();
    else showGate();

    // -------------------------------
    // "No" flow â€” playful but not cringe
    // -------------------------------
    const prompts = [
      { q: "Are you sure?", s: "I think you mis-clicked. Try again." },
      { q: "Waitâ€¦ for real?", s: "Double-check your answer for accuracy." },
      { q: "Okay, but consider the perks.", s: "There may be chocolate involved." },
      { q: "This feels like a bug.", s: "Letâ€™s rerun the test with â€˜Yesâ€™." },
      { q: "Iâ€™m going to ask again nicely.", s: "Will you be my Valentine?" },
      { q: "Final answer?", s: "No pressure. (Tiny pressure.)" }
    ];

    let noCount = 0;

    function setButtonScales() {
      const yesScale = Math.min(1 + noCount * 0.14, 2.35);
      const noScale  = Math.max(1 - noCount * 0.07, 0.62);
      yesBtn.style.transform = `scale(${yesScale})`;
      noBtn.style.transform  = `scale(${noScale})`;
    }

    noBtn.addEventListener("click", () => {
      noCount++;
      const idx = Math.min(noCount - 1, prompts.length - 1);

      questionEl.textContent = prompts[idx].q;
      sublineEl.textContent = prompts[idx].s;

      hintEl.textContent =
        noCount < 2 ? "" :
        noCount < 4 ? "Hint: the correct answer is â€˜Yesâ€™ ğŸ™‚" :
        "I have improved the â€˜Yesâ€™ button for better usability.";

      setButtonScales();

      // subtle shake
      noBtn.animate(
        [
          { transform: noBtn.style.transform + " translateX(0px)" },
          { transform: noBtn.style.transform + " translateX(6px)" },
          { transform: noBtn.style.transform + " translateX(-6px)" },
          { transform: noBtn.style.transform + " translateX(0px)" },
        ],
        { duration: 220, iterations: 1 }
      );
    });

    // Optional: after a few "No"s, the button becomes evasive (subtle)
    noBtn.addEventListener("mouseenter", () => {
      if (noCount < 4) return;
      const x = Math.floor((Math.random() * 110) - 55);
      const y = Math.floor((Math.random() * 40) - 20);
      noBtn.style.position = "relative";
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
    });

    // -------------------------------
    // Yes -> celebration
    // -------------------------------
    function burstConfetti() {
      const emojis = ["ğŸ’–","âœ¨","ğŸŒ¹","ğŸ«","ğŸ¥°","ğŸ’˜"];
      for (let i = 0; i < 26; i++) {
        const s = document.createElement("span");
        s.className = "confetti";
        s.textContent = emojis[(Math.random() * emojis.length) | 0];
        s.style.left = (Math.random() * 100) + "vw";
        s.style.animationDuration = (1.5 + Math.random() * 1.7) + "s";
        document.body.appendChild(s);
        setTimeout(() => s.remove(), 3600);
      }
    }

    yesBtn.addEventListener("click", async () => {
      celebrateEl.classList.remove("hidden");
      celebrateEl.scrollIntoView({ behavior: "smooth", block: "center" });
      burstConfetti();

      try { await song.play(); } catch (_) {}
    });

    confettiBtn.addEventListener("click", burstConfetti);
    scrollTopBtn.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));
  </script>
</body>
</html>